@model List<CAPS.Models.Service>

@{
    ViewData["Title"] = "Services";
}

<div class="services-container">
    <!-- Page Title Banner -->
    <div class="page-title-container">
        <h1 class="page-title">SERVICES</h1>
    </div>

    <!-- New Services Button -->
    <div class="new-services-container">
        <a asp-action="UpSert" class="new-services-btn">
            <i class="bi bi-plus"></i> New Services
        </a>
    </div>

    <!-- Services Categories Overview Panel -->
    <div class="categories-panel">
        <div class="panel-header">
            <h2 class="panel-title">Services Categories Overview</h2>
        </div>
        <div class="panel-content">
            @if (Model.Count > 0)
            {
                var categories = Model.GroupBy(s => s.Category).ToList();
                @if (categories.Any())
                {
                    <div class="categories-grid">
                        @foreach (var category in categories.Take(4))
                        {
                            <div class="category-item">
                                <div class="category-info">
                                    <span class="category-name">@category.Key</span>
                                    <span class="category-count">@category.Count() services</span>
                                </div>
                            </div>
                        }
                    </div>
                }
                else
                {
                    <div class="empty-categories">No categories available</div>
                }
            }
            else
            {
                <div class="empty-categories">No services available</div>
            }
        </div>
    </div>

    <!-- Service Details Panels -->
    <div class="services-details-grid">
        <div class="service-panel">
            <div class="panel-header">
                <h2 class="panel-title">Service Details</h2>
            </div>
            <div class="panel-content">
                @if (Model.Count > 0)
                {
                    <div class="services-list">
                        @{
                            var firstHalfServices = Model.Take((Model.Count + 1) / 2);
                        }
                        @foreach (var item in firstHalfServices)
                        {
                            <div class="service-item">
                                <div class="service-info">
                                    <div class="service-name">@item.Name</div>
                                    <div class="service-category">@item.Category</div>
                                    <div class="service-price">₱@item.Price.ToString("N2")</div>
                                    <div class="service-duration">@item.Duration min</div>
                                </div>
                                <div class="service-actions">
                                    <div class="btn-group" role="group">
                                        <a asp-action="UpSert" asp-route-id="@item.ServiceId" class="btn btn-outline-mint btn-sm" title="Edit">
                                            <i class="bi bi-pencil-square"></i>
                                        </a>
                                        <button type="button" class="btn btn-outline-info btn-sm" title="View Details" 
                                                onclick="showServiceDetails(@item.ServiceId, '@item.Name', '@item.Category', '@item.Description', @item.Price, @item.Duration)">
                                            <i class="bi bi-eye"></i>
                                        </button>
                                        <form asp-action="Delete" asp-route-id="@item.ServiceId" method="post" class="d-inline">
                                            <button type="submit" class="btn btn-outline-danger btn-sm" title="Delete"
                                                    onclick="return confirm('Are you sure you want to delete this service?');">
                                                <i class="bi bi-trash"></i>
                                            </button>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        }
                    </div>
                }
                else
                {
                    <div class="empty-services">No services available</div>
                }
            </div>
        </div>

        <div class="service-panel">
            <div class="panel-header">
                <h2 class="panel-title">Additional Services</h2>
            </div>
            <div class="panel-content">
                @if (Model.Count > 1)
                {
                    <div class="services-list">
                        @{
                            var secondHalfServices = Model.Skip((Model.Count + 1) / 2);
                        }
                        @foreach (var item in secondHalfServices)
                        {
                            <div class="service-item">
                                <div class="service-info">
                                    <div class="service-name">@item.Name</div>
                                    <div class="service-category">@item.Category</div>
                                    <div class="service-price">₱@item.Price.ToString("N2")</div>
                                    <div class="service-duration">@item.Duration min</div>
                                </div>
                                <div class="service-actions">
                                    <div class="btn-group" role="group">
                                        <a asp-action="UpSert" asp-route-id="@item.ServiceId" class="btn btn-outline-mint btn-sm" title="Edit">
                                            <i class="bi bi-pencil-square"></i>
                                        </a>
                                        <button type="button" class="btn btn-outline-info btn-sm" title="View Details" 
                                                onclick="showServiceDetails(@item.ServiceId, '@item.Name', '@item.Category', '@item.Description', @item.Price, @item.Duration)">
                                            <i class="bi bi-eye"></i>
                                        </button>
                                        <form asp-action="Delete" asp-route-id="@item.ServiceId" method="post" class="d-inline">
                                            <button type="submit" class="btn btn-outline-danger btn-sm" title="Delete"
                                                    onclick="return confirm('Are you sure you want to delete this service?');">
                                                <i class="bi bi-trash"></i>
                                            </button>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        }
                    </div>
                }
                else
                {
                    <div class="empty-services">No additional services</div>
                }
            </div>
        </div>
    </div>
</div>

<!-- Service Details Modal -->
<div class="modal fade" id="serviceDetailsModal" tabindex="-1" aria-labelledby="serviceDetailsModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header bg-mint text-white">
                <h5 class="modal-title" id="serviceDetailsModalLabel">
                    <i class="bi bi-info-circle me-2"></i>Service Details
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-6">
                        <h6 class="text-mint">Service Information</h6>
                        <p><strong>Name:</strong> <span id="modalServiceName"></span></p>
                        <p><strong>Category:</strong> <span id="modalServiceCategory"></span></p>
                        <p><strong>Duration:</strong> <span id="modalServiceDuration"></span></p>
                        <p><strong>Price:</strong> <span id="modalServicePrice"></span></p>
                    </div>
                    <div class="col-md-6">
                        <h6 class="text-mint">Description</h6>
                        <p id="modalServiceDescription"></p>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <a href="#" id="modalEditLink" class="btn btn-mint">Edit Service</a>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        function showServiceDetails(serviceId, name, category, description, price, duration) {
            document.getElementById('modalServiceName').textContent = name;
            document.getElementById('modalServiceCategory').textContent = category;
            document.getElementById('modalServiceDuration').textContent = duration + ' minutes';
            document.getElementById('modalServicePrice').textContent = '₱' + price.toFixed(2);
            document.getElementById('modalServiceDescription').textContent = description || 'No description available';
            document.getElementById('modalEditLink').href = '/Service/UpSert/' + serviceId;
            
            var modal = new bootstrap.Modal(document.getElementById('serviceDetailsModal'));
            modal.show();
        }
    </script>
}

<style>
    body {
        background-color: #f8f9fa;
        font-family: 'Georgia', 'Times New Roman', serif;
        margin: 0;
        padding: 0;
    }

    .services-container {
        padding: 30px;
        background-color: #f8f9fa;
        min-height: 100vh;
    }

    .page-title-container {
        background-color: #e8f5e8;
        border: 2px solid #2d5016;
        border-radius: 8px;
        padding: 20px;
        text-align: center;
        margin-bottom: 20px;
    }

    .page-title {
        font-family: 'Georgia', 'Times New Roman', serif;
        font-size: 32px;
        font-weight: bold;
        color: #2d5016;
        margin: 0;
        letter-spacing: 2px;
    }

    .new-services-container {
        margin-bottom: 20px;
    }

    .new-services-btn {
        background-color: #e8f5e8;
        border: 2px solid #2d5016;
        border-radius: 8px;
        padding: 12px 24px;
        color: #2d5016;
        text-decoration: none;
        font-weight: bold;
        font-size: 16px;
        display: inline-flex;
        align-items: center;
        gap: 8px;
        transition: all 0.3s ease;
        font-family: 'Georgia', 'Times New Roman', serif;
    }

    .new-services-btn:hover {
        background-color: #2d5016;
        color: #ffffff;
        text-decoration: none;
    }

    .categories-panel {
        background-color: #ffffff;
        border: 2px solid #e8f5e8;
        border-radius: 8px;
        margin-bottom: 20px;
        overflow: hidden;
    }

    .panel-header {
        background-color: #ffffff;
        padding: 20px 30px;
        border-bottom: 1px solid #e9ecef;
    }

    .panel-title {
        font-family: 'Georgia', 'Times New Roman', serif;
        font-size: 20px;
        font-weight: bold;
        color: #2d5016;
        margin: 0;
    }

    .panel-content {
        padding: 30px;
        background-color: #ffffff;
    }

    .categories-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
    }

    .category-item {
        padding: 15px;
        background-color: #f8f9fa;
        border-radius: 6px;
        border: 1px solid #e9ecef;
    }

    .category-info {
        display: flex;
        flex-direction: column;
    }

    .category-name {
        font-weight: bold;
        color: #2d5016;
        font-size: 16px;
        margin-bottom: 5px;
    }

    .category-count {
        color: #6c757d;
        font-size: 14px;
    }

    .empty-categories {
        text-align: center;
        color: #6c757d;
        font-style: italic;
        padding: 20px;
    }

    .services-details-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
    }

    .service-panel {
        background-color: #ffffff;
        border: 2px solid #e8f5e8;
        border-radius: 8px;
        overflow: hidden;
    }

    .services-list {
        display: flex;
        flex-direction: column;
        gap: 15px;
    }

    .service-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 15px;
        background-color: #f8f9fa;
        border-radius: 6px;
        border: 1px solid #e9ecef;
    }

    .service-info {
        flex: 1;
    }

    .service-name {
        font-weight: bold;
        color: #2d5016;
        font-size: 16px;
        margin-bottom: 5px;
    }

    .service-category {
        color: #6c757d;
        font-size: 14px;
        margin-bottom: 5px;
    }

    .service-price {
        color: #28a745;
        font-weight: bold;
        font-size: 14px;
        margin-bottom: 5px;
    }

    .service-duration {
        color: #6c757d;
        font-size: 14px;
    }

    .service-actions {
        margin-left: 15px;
    }

    .empty-services {
        text-align: center;
        color: #6c757d;
        font-style: italic;
        padding: 20px;
    }

    /* Preserve existing button styles */
    .text-mint {
        color: #2D5A4A !important;
    }
    
    .btn-mint {
        background-color: #2D5A4A;
        border-color: #2D5A4A;
        color: white;
        transition: all 0.3s ease;
    }
    
    .btn-mint:hover {
        background-color: #1a3a2e;
        border-color: #1a3a2e;
        color: white;
        transform: translateY(-2px);
    }
    
    .btn-outline-mint {
        color: #2D5A4A;
        border-color: #2D5A4A;
        transition: all 0.3s ease;
    }
    
    .btn-outline-mint:hover {
        background-color: #2D5A4A;
        border-color: #2D5A4A;
        color: white;
    }

    .modal-header.bg-mint {
        background-color: #2D5A4A !important;
    }
    
    .btn-close-white {
        filter: invert(1) grayscale(100%) brightness(200%);
    }

    /* Responsive Design */
    @@media (max-width: 768px) {
        .services-container {
            padding: 15px;
        }

        .page-title {
            font-size: 24px;
        }

        .services-details-grid {
            grid-template-columns: 1fr;
        }

        .categories-grid {
            grid-template-columns: 1fr;
        }

        .service-item {
            flex-direction: column;
            align-items: flex-start;
            gap: 10px;
        }

        .service-actions {
            margin-left: 0;
            align-self: flex-end;
        }
    }
</style>